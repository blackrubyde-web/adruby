import{r as i,a4 as ye,aQ as ue,aG as ae,a9 as te,a6 as ne,j as e,k as P,aO as He,bt as Ze,aR as Je,aS as We,a7 as we,bn as Qe,ay as Xe,D as se,at as je,B as Ye,aC as er,ax as rr,bu as Se,aL as me,aM as tr,aN as sr}from"./vendor-react-BtVdps6C.js";import{C as xe,P as Q,B as G,L as k,a as ke,b as De,d as ar,f as nr,s as H,I as q,T as ce,e as lr}from"./creative-C4rWjoa1.js";import{f as T}from"./vendor-Cwcl6ryW.js";import{P as ir}from"./PageShell-BcTt0uJw.js";import{H as dr}from"./HeroHeader-D_79mwMf.js";import{C as I}from"./Card-BkrgSx6M.js";import{u as or}from"./useStrategies-CynI3epd.js";import"./vendor-radix-BA32w1ww.js";import"./vendor-supabase-CX3WxO18.js";const W=[{id:1,title:"Wettbewerber-Analyse",icon:ye,description:"Scanne 1.234 √§hnliche Kampagnen...",duration:1e3},{id:2,title:"Zielgruppen-Insights",icon:ue,description:"Analysiere Demografie & Interessen...",duration:1200},{id:3,title:"Performance-Prognose",icon:ae,description:"Berechne erwartete Metriken...",duration:1100},{id:4,title:"KI-Optimierung",icon:te,description:"Optimiere Targeting & Budget...",duration:1300},{id:5,title:"Finale Auswertung",icon:ne,description:"Erstelle Insights-Report...",duration:400}];function cr({progress:t}){const[n,h]=i.useState(0),[D,c]=i.useState(0),w=typeof t=="number"?t:D;return i.useEffect(()=>{if(typeof t=="number"){const f=Math.min(W.length-1,Math.floor(t/100*W.length));h(f);return}let b=0;const S=W.reduce((f,d)=>f+d.duration,0),u=setInterval(()=>{b+=50;const f=Math.min(b/S*100,100);c(f);let d=0;for(let g=0;g<W.length;g++)if(d+=W[g].duration,b<d){h(g);break}},50);return()=>clearInterval(u)},[t]),e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",children:e.jsxs(xe,{className:"bg-card border-border p-8 w-full max-w-2xl",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsxs("div",{className:"relative inline-block mb-6",children:[e.jsx("div",{className:"w-24 h-24 bg-primary rounded-full flex items-center justify-center animate-pulse",children:e.jsx(te,{className:"w-12 h-12 text-primary-foreground animate-spin",style:{animationDuration:"3s"}})}),e.jsx("div",{className:"absolute -top-2 -right-2 w-8 h-8 bg-foreground rounded-full flex items-center justify-center",children:e.jsx(ne,{className:"w-4 h-4 text-background"})})]}),e.jsx("h2",{className:"text-foreground mb-2",children:"KI-Marktanalyse l√§uft"}),e.jsx("p",{className:"text-muted-foreground",children:"Analysiere √ºber 2,5 Millionen Datenpunkte f√ºr optimale Performance..."})]}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsx("span",{className:"text-muted-foreground",children:"Fortschritt"}),e.jsxs("span",{className:"text-foreground font-bold",children:[Math.round(w),"%"]})]}),e.jsx(Q,{value:w,className:"h-3"})]}),e.jsx("div",{className:"space-y-3",children:W.map((b,S)=>{const u=S<n,f=S===n;return e.jsxs("div",{className:`flex items-center gap-4 p-4 rounded-lg transition-all duration-300 ${f?"bg-primary/10 border-2 border-primary":u?"bg-foreground/5 border-2 border-foreground":"bg-muted border-2 border-border"}`,children:[e.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center flex-shrink-0 ${f?"bg-primary animate-pulse":u?"bg-foreground":"bg-border"}`,children:u?e.jsx(P,{className:"w-6 h-6 text-background"}):e.jsx(b.icon,{className:`w-6 h-6 ${f?"text-primary-foreground":"text-muted-foreground"}`})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:`font-medium ${f||u?"text-foreground":"text-muted-foreground"}`,children:b.title}),e.jsx("div",{className:`text-sm ${f?"text-primary":"text-muted-foreground"}`,children:f?b.description:u?"Abgeschlossen":"Ausstehend"})]}),f&&e.jsxs("div",{className:"flex gap-1",children:[e.jsx("div",{className:"w-2 h-2 bg-primary rounded-full animate-bounce",style:{animationDelay:"0s"}}),e.jsx("div",{className:"w-2 h-2 bg-primary rounded-full animate-bounce",style:{animationDelay:"0.2s"}}),e.jsx("div",{className:"w-2 h-2 bg-primary rounded-full animate-bounce",style:{animationDelay:"0.4s"}})]})]},b.id)})}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mt-8",children:[e.jsxs("div",{className:"bg-muted rounded-lg p-4 text-center border border-border",children:[e.jsx("div",{className:"text-2xl text-foreground font-bold",children:"2.5M"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Datenpunkte"})]}),e.jsxs("div",{className:"bg-muted rounded-lg p-4 text-center border border-border",children:[e.jsx("div",{className:"text-2xl text-foreground font-bold",children:"1,234"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Kampagnen"})]}),e.jsxs("div",{className:"bg-muted rounded-lg p-4 text-center border border-border",children:[e.jsx("div",{className:"text-2xl text-foreground font-bold",children:"94%"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Genauigkeit"})]})]})]})})}function mr({copy:t,productName:n}){const h="Deine Ad Headline...",D="Deine Ad Copy wird hier in Echtzeit angezeigt...",c="Jetzt kaufen",w=(t==null?void 0:t.headline)||h,b=(t==null?void 0:t.description)||D,S=(t==null?void 0:t.cta)||c;return e.jsxs(xe,{className:"bg-card border-border p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-foreground font-medium",children:"Live-Vorschau"}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(He,{className:"w-4 h-4"}),e.jsx("span",{children:"Facebook Feed"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg overflow-hidden shadow-lg",children:[e.jsxs("div",{className:"p-3 flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-primary rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-primary-foreground font-bold text-sm",children:n?n.charAt(0):"B"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-gray-900 text-sm",children:n||"Ihr Unternehmen"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Gesponsert ¬∑ üåê"})]}),e.jsx("button",{className:"text-gray-400 hover:text-gray-600",children:e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentColor",children:[e.jsx("circle",{cx:"10",cy:"4",r:"1.5"}),e.jsx("circle",{cx:"10",cy:"10",r:"1.5"}),e.jsx("circle",{cx:"10",cy:"16",r:"1.5"})]})})]}),e.jsxs("div",{className:"px-3 pb-3",children:[e.jsx("p",{className:"text-gray-900 text-sm leading-relaxed",children:w}),e.jsx("p",{className:"text-gray-900 text-sm leading-relaxed",children:b})]}),e.jsxs("div",{className:"bg-gradient-to-br from-black via-gray-800 to-[#C80000] h-64 flex items-center justify-center relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-[#C80000] opacity-20"}),e.jsxs("div",{className:"text-center text-white relative z-10",children:[e.jsx("div",{className:"text-6xl mb-2",children:"üì±"}),e.jsx("p",{className:"text-sm opacity-90 font-medium",children:"Dein Ad Creative"})]})]}),e.jsxs("div",{className:"p-3 bg-gray-50",children:[e.jsxs("div",{className:"text-xs text-gray-600 mb-2",children:[n?n.toLowerCase().replace(/\s+/g,""):"yourwebsite",".com"]}),e.jsx("button",{className:"w-full bg-[#C80000] hover:bg-[#A00000] text-white font-medium py-2 px-4 rounded text-sm transition-colors",children:S})]}),e.jsx("div",{className:"border-t border-gray-200 px-3 py-2 flex items-center justify-between text-gray-500",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{className:"flex items-center gap-1 hover:text-[#C80000] transition-colors",children:[e.jsx(Ze,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:"Gef√§llt mir"})]}),e.jsxs("button",{className:"flex items-center gap-1 hover:text-[#C80000] transition-colors",children:[e.jsx(Je,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:"Kommentieren"})]}),e.jsxs("button",{className:"flex items-center gap-1 hover:text-[#C80000] transition-colors",children:[e.jsx(We,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:"Teilen"})]})]})})]}),e.jsx("div",{className:"mt-4 p-3 bg-muted rounded-lg border border-border",children:e.jsx("p",{className:"text-xs text-muted-foreground",children:"üí° Dies ist eine Live-Vorschau. √Ñnderungen werden in Echtzeit angezeigt."})})]})}function ur({score:t}){const n=c=>c>=90?"text-primary":c>=70?"text-foreground":c>=50?"text-muted-foreground":"text-destructive",h=c=>c>=90?"Exzellent":c>=70?"Gut":c>=50?"Mittel":"Verbesserungsw√ºrdig",D=[{label:"Emotion",value:95},{label:"Klarheit",value:88},{label:"Dringlichkeit",value:92}];return e.jsxs(xe,{className:"bg-card border-border p-6",children:[e.jsx("h3",{className:"text-foreground font-medium mb-6",children:"Conversion-Score"}),e.jsxs("div",{className:"relative mb-8",children:[e.jsxs("div",{className:"w-40 h-40 mx-auto relative",children:[e.jsxs("svg",{className:"w-full h-full transform -rotate-90",children:[e.jsx("circle",{cx:"80",cy:"80",r:"70",stroke:"currentColor",className:"text-border",strokeWidth:"12",fill:"none"}),e.jsx("circle",{cx:"80",cy:"80",r:"70",stroke:"#10b981",strokeWidth:"12",fill:"none",strokeDasharray:`${2*Math.PI*70}`,strokeDashoffset:`${2*Math.PI*70*(1-t/100)}`,strokeLinecap:"round",className:"transition-all duration-1000"})]}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`text-4xl font-bold ${n(t)}`,children:t}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"von 100"})]})})]}),e.jsxs("div",{className:"text-center mt-4",children:[e.jsx("div",{className:`font-bold ${n(t)}`,children:h(t)}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Conversion-Potential"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-foreground text-sm font-medium mb-3",children:"Score-Faktoren"}),D.map((c,w)=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between text-sm mb-2",children:[e.jsx("span",{className:"text-muted-foreground",children:c.label}),e.jsxs("span",{className:"text-foreground font-bold",children:[c.value,"%"]})]}),e.jsx("div",{className:"h-2 bg-border rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-blue-500 to-purple-500 transition-all duration-1000 rounded-full",style:{width:`${c.value}%`}})})]},w))]}),e.jsxs("div",{className:"mt-6 space-y-2",children:[e.jsxs("div",{className:"flex items-start gap-2 p-3 bg-primary/10 border border-primary rounded-lg",children:[e.jsx(ae,{className:"w-4 h-4 text-primary mt-0.5 flex-shrink-0"}),e.jsx("p",{className:"text-xs text-foreground",children:"Starke emotionale Ansprache erkannt"})]}),e.jsxs("div",{className:"flex items-start gap-2 p-3 bg-foreground/10 border border-foreground rounded-lg",children:[e.jsx(ne,{className:"w-4 h-4 text-foreground mt-0.5 flex-shrink-0"}),e.jsx("p",{className:"text-xs text-foreground",children:"Klarer Call-to-Action vorhanden"})]}),e.jsxs("div",{className:"flex items-start gap-2 p-3 bg-muted border border-border rounded-lg",children:[e.jsx(we,{className:"w-4 h-4 text-muted-foreground mt-0.5 flex-shrink-0"}),e.jsx("p",{className:"text-xs text-foreground",children:"Zielgruppe pr√§zise adressiert"})]})]})]})}const Ne={professional:{icon:te,color:"text-blue-500",bg:"bg-blue-500/10",label:"Professional"},friendly:{icon:je,color:"text-green-500",bg:"bg-green-500/10",label:"Friendly"},urgent:{icon:ne,color:"text-orange-500",bg:"bg-orange-500/10",label:"Urgent"},emotional:{icon:je,color:"text-purple-500",bg:"bg-purple-500/10",label:"Emotional"}};function ve({productName:t="",productDescription:n="",targetAudience:h="",uniqueSellingPoint:D="",strategyId:c=null,onSelectCopy:w}){const[b,S]=i.useState(!1),[u,f]=i.useState([]),[d,g]=i.useState(null),[_,z]=i.useState("all"),O=["professional","friendly","urgent","emotional"],A=l=>{switch(l){case"professional":return"trustworthy";case"friendly":return"playful";case"urgent":return"bold";case"emotional":return"direct";default:return"trustworthy"}},R=async()=>{var l;if(!t||!h||!D){T.error("Bitte Produktname, Zielgruppe und USP ausf√ºllen.");return}S(!0);try{const a=new FormData;a.append("brandName",t),a.append("productName",t),a.append("audience",h),a.append("offer",D),a.append("tone",A(_)),a.append("goal","sales"),a.append("language","de"),n&&a.append("inspiration",n),c&&a.append("strategyId",c);const p=await ke(a),$=(((l=(await De({brief:p.brief,hasImage:!1,strategyId:c})).output)==null?void 0:l.creatives)||[]).map((L,M)=>{var le;const Z=((le=L.score)==null?void 0:le.value)??70,de=O[M%O.length];return{id:M+1,headline:L.copy.hook,description:L.copy.primary_text,cta:L.copy.cta,tone:de,predictedCTR:Number(Math.max(1.5,Math.min(8,Z/12)).toFixed(1)),predictedCVR:Number(Math.max(1.2,Math.min(7,Z/14)).toFixed(1))}});f($),g(null),T.success(`üéâ ${$.length} AI-Varianten generiert`)}catch(a){const p=a instanceof Error?a.message:"Copy generation failed";T.error(p)}finally{S(!1)}},U=l=>{g(l.id),w&&w(l),T.success(`‚úÖ Copy variant ${l.id} selected`)},B=l=>{const a=`Headline: ${l.headline}
Description: ${l.description}
CTA: ${l.cta}`;navigator.clipboard.writeText(a),T.success("üìã Copied to clipboard!")},v=_==="all"?u:u.filter(l=>l.tone===_);return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"border-b border-border p-6 bg-gradient-to-r from-primary/5 to-transparent",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-10 h-10 bg-primary rounded-lg flex items-center justify-center",children:e.jsx(Qe,{className:"w-5 h-5 text-primary-foreground"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-foreground font-bold",children:"AI Copy Assistant"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"AI-powered ad copy generator"})]})]}),e.jsx(G,{onClick:R,disabled:b,className:"w-full bg-gradient-to-r from-primary to-primary/80 text-primary-foreground hover:opacity-90 transition-opacity mt-4",children:b?e.jsxs(e.Fragment,{children:[e.jsx(Xe,{className:"w-4 h-4 mr-2 animate-spin"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(se,{className:"w-4 h-4 mr-2"}),"Generate Copy Variants"]})})]}),u.length>0&&e.jsxs("div",{className:"p-4 border-b border-border bg-card",children:[e.jsx(k,{className:"text-xs text-muted-foreground mb-2 block",children:"Filter by Tone"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("button",{onClick:()=>z("all"),className:`px-3 py-1.5 rounded-lg text-xs font-medium transition-all ${_==="all"?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground hover:bg-muted/80"}`,children:["All (",u.length,")"]}),Object.entries(Ne).map(([l,a])=>{const p=u.filter(C=>C.tone===l).length;return e.jsxs("button",{onClick:()=>z(l),className:`px-3 py-1.5 rounded-lg text-xs font-medium transition-all flex items-center gap-1 ${_===l?`${a.bg} ${a.color}`:"bg-muted text-muted-foreground hover:bg-muted/80"}`,children:[e.jsx(a.icon,{className:"w-3 h-3"}),a.label," (",p,")"]},l)})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:u.length===0?e.jsx("div",{className:"h-full flex items-center justify-center",children:e.jsxs("div",{className:"text-center p-8",children:[e.jsx(se,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4 opacity-50"}),e.jsx("p",{className:"text-muted-foreground text-sm mb-2",children:"No copy variants yet"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:'Click "Generate Copy Variants" to get AI-powered suggestions'})]})}):v.map(l=>{const a=Ne[l.tone],p=a.icon;return e.jsxs("div",{className:`border-2 rounded-xl p-4 transition-all cursor-pointer hover:shadow-lg ${d===l.id?"border-primary bg-primary/5 shadow-lg shadow-primary/20":"border-border bg-card hover:border-primary/30"}`,onClick:()=>U(l),children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-8 h-8 ${a.bg} rounded-lg flex items-center justify-center`,children:e.jsx(p,{className:`w-4 h-4 ${a.color}`})}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Variant #",l.id]}),e.jsxs("div",{className:`text-xs ${a.color} font-medium`,children:[a.label," Tone"]})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:C=>{C.stopPropagation(),B(l)},className:"p-1.5 hover:bg-muted rounded-lg transition-colors",children:e.jsx(Ye,{className:"w-3.5 h-3.5 text-muted-foreground"})}),d===l.id&&e.jsx("div",{className:"p-1.5 bg-primary rounded-lg",children:e.jsx(P,{className:"w-3.5 h-3.5 text-primary-foreground"})})]})]}),e.jsxs("div",{className:"space-y-2 mb-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"Headline"}),e.jsx("p",{className:"text-sm font-semibold text-foreground",children:l.headline})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"Description"}),e.jsx("p",{className:"text-xs text-foreground leading-relaxed",children:l.description})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"Call-to-Action"}),e.jsx("div",{className:"inline-block px-3 py-1 bg-primary rounded-lg",children:e.jsx("p",{className:"text-xs font-medium text-primary-foreground",children:l.cta})})]})]}),e.jsxs("div",{className:"flex items-center gap-4 pt-3 border-t border-border",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(we,{className:"w-3.5 h-3.5 text-blue-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"CTR"}),e.jsxs("div",{className:"text-sm font-bold text-foreground",children:[l.predictedCTR,"%"]})]})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(ae,{className:"w-3.5 h-3.5 text-green-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"CVR"}),e.jsxs("div",{className:"text-sm font-bold text-foreground",children:[l.predictedCVR,"%"]})]})]})]})]},l.id)})}),u.length>0&&e.jsx("div",{className:"border-t border-border p-4 bg-muted",children:e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(er,{className:"w-3.5 h-3.5"}),e.jsxs("span",{children:["Generated ",u.length," variants in 2s"]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("button",{className:"px-3 py-1.5 bg-card rounded-lg hover:bg-card/80 transition-colors text-foreground",children:[e.jsx(rr,{className:"w-3.5 h-3.5 inline mr-1"}),"Export All"]})})]})})]})}const Ce={currentStep:1,formData:{brandName:"",productName:"",productDescription:"",targetAudience:"",ageRange:"",interests:"",painPoints:"",uniqueSellingPoint:"",budget:"",duration:"",objective:"conversions",strategyId:""}};function xr(t,n){switch(n.type){case"SET_FIELD":return{...t,formData:{...t.formData,[n.field]:n.value}};case"NEXT_STEP":return{...t,currentStep:Math.min(t.currentStep+1,6)};case"PREV_STEP":return{...t,currentStep:Math.max(t.currentStep-1,1)};case"SET_STEP":return{...t,currentStep:n.step};case"LOAD_DRAFT":return{currentStep:n.payload.currentStep??t.currentStep,formData:{...t.formData,...n.payload.formData||{}}};case"RESET":return Ce;default:return t}}function hr(){const[t,n]=i.useState("idle"),[h,D]=i.useState(null),[c,w]=i.useState(null),[b,S]=i.useState(null),[u,f]=i.useState(null),[d,g]=i.useState(null),[_,z]=i.useState(null),[O,A]=i.useState(null),R=i.useRef({cancelled:!1});i.useEffect(()=>{const l=R;return()=>{l.current.cancelled=!0}},[]);const U=i.useCallback(async l=>{z(null),n("analyzing"),A(null);try{const a=await ke(l);return D(a.brief),w(a.image??null),n("idle"),a}catch(a){const p=a instanceof Error?a.message:"Analyze failed";throw z(p),n("error"),a}},[]),B=i.useCallback(async l=>{z(null),n("generating"),A(null),R.current.cancelled=!1;try{const a=await De(l);if(A(a.jobId??null),a.jobId){n("polling");const p=20;let C=0;for(;!R.current.cancelled&&C<p;){C+=1;try{const m=await ar(a.jobId);if(typeof(m==null?void 0:m.progress)=="number"&&g(Number(m.progress)),m!=null&&m.status&&n(m.status==="complete"?"complete":"polling"),m!=null&&m.id&&A(m.id),(m==null?void 0:m.status)==="complete")return S(m.outputs??null),f(m.score??null),n("complete"),m}catch{}await new Promise(m=>setTimeout(m,1500+Math.min(4e3,C*400)))}throw R.current.cancelled?(n("idle"),new Error("Poll cancelled")):new Error("Polling timed out")}return S(a.output??null),f(a.quality??null),n("complete"),a}catch(a){const p=a instanceof Error?a.message:"Generate failed";throw z(p),n("error"),A(null),a}},[]),v=i.useCallback(()=>{R.current.cancelled=!0},[]);return{status:t,brief:h,imageMeta:c,result:b,quality:u,progress:d,jobId:O,error:_,analyze:U,generate:B,cancel:v}}function fr({limit:t=5,selectedIds:n=[],onToggle:h,refreshKey:D=0}){const[c,w]=i.useState([]),[b,S]=i.useState(!1),[u,f]=i.useState(null);return i.useEffect(()=>{let d=!0;return S(!0),nr(t).then(g=>{d&&w(g.items||[])}).catch(g=>{d&&f((g==null?void 0:g.message)||String(g))}).finally(()=>d&&S(!1)),()=>{d=!1}},[t,D]),b?e.jsx("div",{children:"Loading research..."}):u?e.jsxs("div",{className:"text-red-600",children:["Error: ",u]}):c.length?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("button",{type:"button",className:"text-xs text-primary underline",onClick:()=>{c.forEach(d=>h&&!(n!=null&&n.includes(d.id))&&h(d.id))},children:"Select all"}),e.jsx("button",{type:"button",className:"text-xs text-muted-foreground underline",onClick:()=>{c.forEach(d=>h&&(n==null?void 0:n.includes(d.id))&&h(d.id))},children:"Clear"})]}),c.map(d=>{const g=n==null?void 0:n.includes(d.id);return e.jsxs("label",{className:"p-3 border rounded flex items-start gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:g,onChange:()=>h&&h(d.id),className:"mt-1"}),d.image_url?e.jsx("img",{src:d.image_url,alt:d.headline||"",className:"w-16 h-16 object-cover rounded"}):e.jsx("div",{className:"w-16 h-16 bg-border rounded"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:d.page_name||d.ad_library_id}),e.jsx("div",{className:"text-sm text-muted-foreground",children:d.headline}),e.jsx("div",{className:"mt-2 text-sm",children:d.primary_text})]})]},d.id)})]}):e.jsx("div",{className:"text-sm text-muted-foreground",children:"No research ads found."})}const ee="ad_ruby_ad_builder_draft",re=[{id:1,name:"Produkt & Messaging",icon:se},{id:2,name:"Zielgruppe",icon:ue},{id:3,name:"Ad Creative",icon:Se},{id:4,name:"Marktanalyse",icon:ye},{id:5,name:"Performance",icon:ae},{id:6,name:"Review & Launch",icon:me}];function kr(){const[t,n]=i.useReducer(xr,Ce),{strategies:h,loading:D,error:c}=or(),[w,b]=i.useState(!1),[S,u]=i.useState(0),[f,d]=i.useState(null),[g,_]=i.useState(null),[z,O]=i.useState(!1),[A,R]=i.useState(null),[U,B]=i.useState(null),[v,l]=i.useState([]),[a,p]=i.useState(null),[C,m]=i.useState(null),[$,L]=i.useState(null),[M,Z]=i.useState([]),[de,le]=i.useState(0),he=i.useMemo(()=>h.find(r=>r.id===t.formData.strategyId)??null,[h,t.formData.strategyId]);i.useEffect(()=>{const r=localStorage.getItem(ee);if(r)try{const s=JSON.parse(r);(s!=null&&s.formData||s!=null&&s.currentStep)&&(n({type:"LOAD_DRAFT",payload:{currentStep:s.currentStep,formData:s.formData}}),l(s.generatedCopy||[]),p(s.selectedCopy??null),m(s.selectedVisualStyle??null),L(s.selectedCTA??null),Z(s.selectedResearchIds||[]),R(s.updatedAt||null),B(s.draftId||null),O(!0))}catch{localStorage.removeItem(ee)}},[]),i.useEffect(()=>{let r=!1;return(async()=>{const{data:s}=await H.auth.getSession();if(!s.session||r)return;const{data:o,error:x}=await H.from("generated_creatives").select("id,inputs,created_at").eq("saved",!1).order("created_at",{ascending:!1}).limit(10);if(r||x||!(o!=null&&o.length))return;const j=o.find(J=>{var be;const V=J.inputs||{};return(V==null?void 0:V.createdFrom)==="ad_builder"&&((be=V==null?void 0:V.lifecycle)==null?void 0:be.status)==="draft"});if(!j)return;const E=A?Date.parse(A):0,N=j.created_at?Date.parse(String(j.created_at)):0;if(E&&N&&N<=E)return;const y=j.inputs||{};n({type:"LOAD_DRAFT",payload:{currentStep:y.currentStep??1,formData:y.formData??{}}}),l(y.generatedCopy||[]),p(y.selectedCopy??null),m(y.selectedVisualStyle??null),L(y.selectedCTA??null),Z(y.researchIds||[]),R(j.created_at||null),B(j.id||null),O(!0)})(),()=>{r=!0}},[A]),i.useEffect(()=>{const r=Object.values(t.formData).some(x=>x&&x!=="conversions"),s=v.length>0||a!==null||$||C;if(!r&&!s&&t.currentStep===1){localStorage.removeItem(ee);return}const o={draftId:U,currentStep:t.currentStep,formData:t.formData,generatedCopy:v,selectedCopy:a,selectedVisualStyle:C,selectedCTA:$,selectedResearchIds:M,updatedAt:new Date().toISOString()};localStorage.setItem(ee,JSON.stringify(o))},[v,a,$,C,M,U,t.currentStep,t.formData]);const Ae=()=>{localStorage.removeItem(ee),n({type:"RESET"}),l([]),p(null),m(null),L(null),B(null),O(!1),R(null)},[fe,Ee]=i.useState(!1),Ie=i.useMemo(()=>{if(!A)return"Draft restored";try{return`Draft restored (${new Date(A).toLocaleString("de-DE")})`}catch{return"Draft restored"}},[A]),F=(r,s)=>{n({type:"SET_FIELD",field:r,value:s})},Pe=r=>{switch(r){case"leads":return"leads";case"traffic":return"traffic";case"app_installs":return"app_installs";default:return"sales"}},ge=r=>new Promise(s=>setTimeout(s,r)),Re=()=>{const r=[t.formData.productName,t.formData.brandName].map(o=>o==null?void 0:o.trim()).filter(Boolean).join(" ");return r?`https://www.facebook.com/ads/library/?active_status=all&ad_type=all&country=DE&q=${encodeURIComponent(r)}&search_type=keyword_unordered`:null},{status:oe,analyze:Te,generate:_e,result:ie,quality:K,progress:Be,jobId:X,error:Me}=hr();i.useEffect(()=>{X&&B(X)},[X]);const Y=oe==="generating"||oe==="polling",ze=async(r,{retries:s=2,baseDelayMs:o=400}={})=>{for(let x=0;x<=s;x+=1)try{return await r()}catch(j){if(x>=s)throw j;const E=o*Math.pow(2,x);await ge(E)}throw new Error("Retry failed")},$e=r=>{if(!r||typeof r!="object")return null;const s=r;return s.output??s.outputs??null},Le=()=>{const r=a!==null?v[a]:v[0]||null;return{productName:t.formData.productName,targetAudience:t.formData.targetAudience,objective:t.formData.objective,budget:t.formData.budget,headline:(r==null?void 0:r.headline)||null,description:(r==null?void 0:r.description)||null,cta:(r==null?void 0:r.cta)||null,strategyId:t.formData.strategyId||null,researchIds:M,formData:t.formData,currentStep:t.currentStep,generatedCopy:v,selectedCopy:a,selectedVisualStyle:C,selectedCTA:$,lifecycle:{status:"draft"},createdFrom:"ad_builder"}},Fe=async()=>{var r,s;try{const{data:o}=await H.auth.getSession(),x=(s=(r=o.session)==null?void 0:r.user)==null?void 0:s.id;if(!x)throw new Error("Bitte zuerst anmelden.");const j=Le(),E=X||U;if(E){const{data:N,error:y}=await H.from("generated_creatives").select("inputs").eq("id",E).maybeSingle();if(y)throw y;const J={...N!=null&&N.inputs&&typeof N.inputs=="object"?N.inputs:{},...j},{error:V}=await H.from("generated_creatives").update({inputs:J,saved:!1,status:"draft"}).eq("id",E);if(V)throw V;B(E)}else{const{data:N,error:y}=await H.from("generated_creatives").insert({user_id:x,inputs:j,outputs:null,saved:!1,status:"draft",progress:0}).select("id").single();if(y)throw y;N!=null&&N.id&&B(N.id)}T.success("Draft gespeichert")}catch(o){const x=o instanceof Error?o.message:"Draft speichern fehlgeschlagen";T.error(x)}},Ke=async()=>{d(null),u(0);const r=window.setInterval(()=>{u(s=>Math.min(s+7,90))},500);try{const s=Re();if(!s)throw new Error("Bitte Produktname oder Brand angeben.");await ze(async()=>{var J;const o="".replace(/\/$/,""),x=o?`${o}/api/ad-research-start`:"/api/ad-research-start",{data:j}=await H.auth.getSession(),E=(J=j.session)==null?void 0:J.access_token,N=await fetch(x,{method:"POST",headers:{...E?{Authorization:`Bearer ${E}`}:{},"Content-Type":"application/json"},body:JSON.stringify({searchUrl:s,maxAds:20})}),y=await N.json();if(!N.ok)throw new Error((y==null?void 0:y.error)||"Market analysis failed");return y}),u(100),await ge(400),le(o=>o+1)}finally{window.clearInterval(r)}},Ve=async()=>{if(t.currentStep===3){n({type:"SET_STEP",step:4}),b(!0);try{await Ke(),n({type:"SET_STEP",step:5})}catch(r){const s=r instanceof Error?r.message:"Analyse fehlgeschlagen. Bitte erneut versuchen.";d(s),n({type:"SET_STEP",step:3})}finally{b(!1)}return}t.currentStep<re.length&&n({type:"NEXT_STEP"})},Ge=()=>{t.currentStep>1&&!w&&n({type:"PREV_STEP"})},Oe=()=>{switch(t.currentStep){case 1:return"Continue to Targeting";case 2:return"Continue to Creative";case 3:return"Analyze Market";case 5:return"Review Campaign";case 6:return"Complete";default:return"Continue"}},pe=!!t.formData.productName&&!!t.formData.targetAudience&&!!t.formData.uniqueSellingPoint,qe=async()=>{if(!(!pe||Y)){_(null);try{const r=new FormData;r.append("brandName",t.formData.brandName||t.formData.productName||"AdRuby"),r.append("productName",t.formData.productName),r.append("audience",t.formData.targetAudience),r.append("offer",t.formData.uniqueSellingPoint||t.formData.productDescription||""),r.append("tone","direct"),r.append("goal",Pe(t.formData.objective)),r.append("funnel","cold"),r.append("language","de"),r.append("format","4:5"),r.append("inspiration",t.formData.productDescription||""),t.formData.strategyId&&r.append("strategyId",t.formData.strategyId);const s=await Te(r),o=await _e({brief:s.brief,hasImage:!1,strategyId:t.formData.strategyId||void 0,researchIds:M.length?M:void 0}),x=$e(o)??ie??null,E=(Array.isArray(x==null?void 0:x.creatives)?x.creatives:[]).map(N=>({headline:N.copy.hook||"",description:N.copy.primary_text||"",cta:N.copy.cta||"Mehr erfahren"}));l(E),p(null)}catch(r){const s=r instanceof Error?r.message:Me||"Generate failed.";_(s)}finally{}}},Ue=t.currentStep/re.length*100;return e.jsxs(ir,{children:[e.jsx(dr,{title:"Ad Builder",subtitle:"Create high-performing Facebook ads with AI-powered targeting, creative optimization, and automated workflows"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"p-5 rounded-lg bg-muted/50 border border-border",children:[e.jsx("div",{className:"text-sm text-muted-foreground mb-1",children:"Ads Created"}),e.jsx("div",{className:"text-2xl font-bold text-foreground",children:"24"})]}),e.jsxs("div",{className:"p-5 rounded-lg bg-muted/50 border border-border",children:[e.jsx("div",{className:"text-sm text-muted-foreground mb-1",children:"Avg. ROAS"}),e.jsx("div",{className:"text-2xl font-bold text-foreground",children:"4.8x"})]}),e.jsxs("div",{className:"p-5 rounded-lg bg-muted/50 border border-border",children:[e.jsx("div",{className:"text-sm text-muted-foreground mb-1",children:"Avg. CTR"}),e.jsx("div",{className:"text-2xl font-bold text-foreground",children:"3.2%"})]}),e.jsxs("div",{className:"p-5 rounded-lg bg-muted/50 border border-border",children:[e.jsx("div",{className:"text-sm text-muted-foreground mb-1",children:"Active Ads"}),e.jsx("div",{className:"text-2xl font-bold text-foreground",children:"12"})]})]}),e.jsxs(I,{className:"p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:re.map((r,s)=>e.jsxs("div",{className:"flex items-center flex-1",children:[e.jsxs("div",{className:"flex flex-col items-center flex-1",children:[e.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center mb-2 transition-all border-2 ${t.currentStep>r.id||t.currentStep===r.id?"bg-primary border-primary text-primary-foreground":"bg-transparent border-border text-muted-foreground"}`,children:t.currentStep>r.id?e.jsx(P,{className:"w-6 h-6"}):e.jsx(r.icon,{className:"w-6 h-6"})}),e.jsx("span",{className:`text-sm text-center ${t.currentStep>=r.id?"text-foreground":"text-muted-foreground"}`,children:r.name})]}),s<re.length-1&&e.jsx("div",{className:`h-0.5 flex-1 mx-2 rounded ${t.currentStep>r.id?"bg-primary":"bg-border"}`})]},r.id))}),e.jsx(Q,{value:Ue,className:"h-2"})]}),w&&e.jsx(cr,{progress:S}),z&&e.jsxs(I,{className:"p-4 border border-primary/20 bg-primary/5 flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-foreground",children:Ie}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"You can continue where you left off or reset the draft."})]}),e.jsx(G,{variant:"outline",onClick:Ae,children:"Reset draft"})]}),f&&e.jsx("div",{className:"p-4 border border-red-500/20 bg-red-500/10 rounded-xl text-sm text-red-600",children:f}),!w&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-4 lg:gap-6 w-full max-w-full overflow-x-hidden",children:[e.jsx("div",{className:"lg:col-span-2 min-w-0",children:e.jsxs(I,{className:"bg-card border-border p-4 sm:p-6 min-w-0",children:[t.currentStep===1&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6 min-w-0",children:[e.jsx("div",{className:"w-10 h-10 bg-primary rounded-lg flex items-center justify-center shrink-0",children:e.jsx(se,{className:"w-6 h-6 text-primary-foreground"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h2",{className:"text-foreground truncate",children:"Produkt-Input f√ºr Conversion-Ad"}),e.jsx("p",{className:"text-muted-foreground text-sm break-words",children:"Geben Sie Ihre Produktdaten ein f√ºr die KI-Analyse"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(k,{className:"text-foreground mb-2",children:"Brand/Unternehmen"}),e.jsx(q,{value:t.formData.brandName,onChange:r=>F("brandName",r.target.value),placeholder:"z.B: BlackRuby Performance",className:"bg-input border-border text-foreground w-full max-w-full"})]}),e.jsxs("div",{children:[e.jsx(k,{className:"text-foreground mb-2",children:"Produktname *"}),e.jsx(q,{value:t.formData.productName,onChange:r=>F("productName",r.target.value),placeholder:"z.B: FitMax Pro Supplement",className:"bg-input border-border text-foreground w-full max-w-full"})]}),e.jsxs("div",{children:[e.jsx(k,{className:"text-foreground mb-2",children:"Produktbeschreibung *"}),e.jsx(ce,{value:t.formData.productDescription,onChange:r=>F("productDescription",r.target.value),placeholder:"Detaillierte Beschreibung Ihres Produkts...",rows:4,className:"bg-input border-border text-foreground w-full max-w-full"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(k,{className:"text-foreground mb-2",children:"Branche"}),e.jsx(q,{placeholder:"E-Commerce",className:"bg-input border-border text-foreground w-full max-w-full"})]}),e.jsxs("div",{children:[e.jsx(k,{className:"text-foreground mb-2",children:"Preis"}),e.jsx(q,{placeholder:"‚Ç¨49.99",className:"bg-input border-border text-foreground w-full max-w-full"})]})]}),e.jsxs("div",{children:[e.jsx(k,{className:"text-foreground mb-2",children:"Hauptnutzen *"}),e.jsx(ce,{value:t.formData.uniqueSellingPoint,onChange:r=>F("uniqueSellingPoint",r.target.value),placeholder:"Die wichtigsten Vorteile Ihres Produkts...",rows:3,className:"bg-input border-border text-foreground w-full max-w-full"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between gap-2 mb-2",children:[e.jsx(k,{className:"text-foreground",children:"Strategy Blueprint"}),D&&e.jsx("span",{className:"text-xs text-muted-foreground",children:"Lade Strategien‚Ä¶"})]}),c&&e.jsx("div",{className:"text-xs text-red-600 mb-2",children:c}),h.length===0&&!D?e.jsx("div",{className:"text-sm text-muted-foreground bg-muted rounded-lg p-4 border border-border",children:"Noch keine Strategies verf√ºgbar. Importiere Blueprints, um sie hier zu sehen."}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:h.map(r=>e.jsx("button",{type:"button",onClick:()=>F("strategyId",r.id),className:`text-left border-2 rounded-lg p-4 transition-all w-full min-w-0 ${t.formData.strategyId===r.id?"border-primary bg-primary/10":"border-border bg-card hover:border-muted-foreground"}`,children:e.jsxs("div",{className:"flex items-start justify-between gap-2 min-w-0",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:r.category||"general"}),e.jsx("div",{className:"font-medium text-foreground truncate",children:r.title}),e.jsx("div",{className:"text-xs text-muted-foreground mt-2 line-clamp-3",children:r.raw_content_markdown.slice(0,160)})]}),t.formData.strategyId===r.id&&e.jsx(P,{className:"w-5 h-5 text-primary shrink-0"})]})},r.id))}),he&&e.jsxs("div",{className:"mt-3 text-xs text-muted-foreground",children:["Ausgew√§hlt: ",e.jsx("span",{className:"font-medium",children:he.title})]})]})]})]}),t.currentStep===2&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6 min-w-0",children:[e.jsx("div",{className:"w-10 h-10 bg-primary rounded-lg flex items-center justify-center shrink-0",children:e.jsx(ue,{className:"w-6 h-6 text-primary-foreground"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h2",{className:"text-foreground truncate",children:"Zielgruppen-Targeting"}),e.jsx("p",{className:"text-muted-foreground text-sm break-words",children:"KI-gest√ºtzte Audience-Definition"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(k,{className:"text-foreground mb-2",children:"Zielgruppe *"}),e.jsx(q,{value:t.formData.targetAudience,onChange:r=>F("targetAudience",r.target.value),placeholder:"z.B: Fitness-Enthusiasten, 25-45 Jahre",className:"bg-input border-border text-foreground w-full max-w-full"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(k,{className:"text-foreground mb-2",children:"Altersbereich"}),e.jsx(q,{value:t.formData.ageRange,onChange:r=>F("ageRange",r.target.value),placeholder:"25-45",className:"bg-input border-border text-foreground w-full max-w-full"})]}),e.jsxs("div",{children:[e.jsx(k,{className:"text-foreground mb-2",children:"Geschlecht"}),e.jsx(q,{placeholder:"Alle / M√§nnlich / Weiblich",className:"bg-input border-border text-foreground w-full max-w-full"})]})]}),e.jsxs("div",{children:[e.jsx(k,{className:"text-foreground mb-2",children:"Interessen & Hobbies"}),e.jsx(q,{value:t.formData.interests,onChange:r=>F("interests",r.target.value),placeholder:"Fitness, Gesundheit, Ern√§hrung, Sport",className:"bg-input border-border text-foreground w-full max-w-full"})]}),e.jsxs("div",{children:[e.jsx(k,{className:"text-foreground mb-2",children:"Pain Points"}),e.jsx(ce,{value:t.formData.painPoints,onChange:r=>F("painPoints",r.target.value),placeholder:"Welche Probleme l√∂st Ihr Produkt?",rows:3,className:"bg-input border-border text-foreground w-full max-w-full"})]}),e.jsx("div",{className:"bg-muted rounded-lg p-4 border border-border w-full max-w-full overflow-hidden",children:e.jsxs("div",{className:"flex items-start gap-3 min-w-0",children:[e.jsx(te,{className:"w-5 h-5 text-primary mt-1 shrink-0"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h3",{className:"text-foreground mb-1",children:"KI-Empfehlung"}),e.jsx("p",{className:"text-sm text-muted-foreground break-words",children:'Basierend auf Ihren Eingaben empfehlen wir zus√§tzliche Targeting-Optionen: "Personen die k√ºrzlich Fitness-Apps installiert haben" und "Online-K√§ufer im Health-Segment"'})]})]})})]})]}),t.currentStep===3&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6 min-w-0",children:[e.jsx("div",{className:"w-10 h-10 bg-primary rounded-lg flex items-center justify-center shrink-0",children:e.jsx(Se,{className:"w-6 h-6 text-primary-foreground"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h2",{className:"text-foreground truncate",children:"Ad Creative Generierung"}),e.jsx("p",{className:"text-muted-foreground text-sm break-words",children:"KI-generierte Copy & Visuals"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 mb-3",children:[e.jsx(k,{className:"text-foreground",children:"Ad Copy Varianten"}),e.jsxs(G,{onClick:qe,size:"sm",disabled:!pe||Y,className:"bg-primary hover:bg-primary/90 text-primary-foreground w-full sm:w-auto",children:[e.jsx(ne,{className:`w-4 h-4 mr-2 ${Y?"animate-pulse":""}`}),Y?"Generiere‚Ä¶":"KI generieren"]})]}),g&&e.jsx("div",{className:"text-sm text-red-600 mb-2",children:g}),v.length>0?e.jsx("div",{className:"space-y-3",children:v.map((r,s)=>e.jsx("div",{onClick:()=>p(s),className:`p-4 rounded-lg border-2 cursor-pointer transition-all min-w-0 ${a===s?"border-primary bg-primary/10":"border-border bg-card hover:border-muted-foreground"}`,children:e.jsxs("div",{className:"flex items-start justify-between min-w-0 gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"text-xs text-muted-foreground mb-1",children:["Variante ",s+1]}),e.jsx("p",{className:"text-foreground break-words",children:r.headline}),e.jsx("p",{className:"text-foreground text-sm break-words",children:r.description})]}),a===s&&e.jsx(P,{className:"w-5 h-5 text-primary shrink-0 ml-2"})]})},s))}):e.jsxs("div",{className:"bg-muted rounded-lg p-8 text-center border border-border",children:[e.jsx(se,{className:"w-12 h-12 text-muted-foreground mx-auto mb-3"}),e.jsx("p",{className:"text-muted-foreground break-words",children:'Klicken Sie auf "KI generieren" um automatische Ad Copy zu erstellen'})]})]}),e.jsxs("div",{children:[e.jsx(k,{className:"text-foreground mb-3",children:"Visual Style"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[{name:"Modern & Clean",gradient:"from-blue-500 to-cyan-400"},{name:"Bold & Vibrant",gradient:"from-primary to-orange-500"},{name:"Minimalistisch",gradient:"from-gray-800 to-gray-600"}].map(r=>e.jsxs("div",{onClick:()=>m(r.name),className:`border-2 rounded-lg p-4 text-center cursor-pointer transition-all w-full min-w-0 ${C===r.name?"border-primary bg-primary/10":"border-border bg-card hover:border-muted-foreground"}`,children:[e.jsx("div",{className:`w-full h-20 bg-gradient-to-br ${r.gradient} rounded mb-2 relative`,children:C===r.name&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx(P,{className:"w-8 h-8 text-white drop-shadow-lg"})})}),e.jsx("p",{className:"text-sm text-foreground font-medium truncate",children:r.name})]},r.name))})]}),e.jsxs("div",{children:[e.jsx(k,{className:"text-foreground mb-3",children:"Call-to-Action"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:["Jetzt kaufen","Mehr erfahren","Kostenlos testen","Angebot sichern"].map(r=>e.jsx("div",{onClick:()=>L(r),className:`border-2 rounded-lg p-4 text-center cursor-pointer transition-all w-full min-w-0 ${$===r?"border-primary bg-primary/10":"border-border bg-card hover:border-muted-foreground"}`,children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("p",{className:"text-foreground font-medium truncate",children:r}),$===r&&e.jsx(P,{className:"w-5 h-5 text-primary shrink-0"})]})},r))})]})]})]}),t.currentStep===5&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6 min-w-0",children:[e.jsx("div",{className:"w-10 h-10 bg-primary rounded-lg flex items-center justify-center shrink-0",children:e.jsx(ae,{className:"w-6 h-6 text-primary-foreground"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h2",{className:"text-foreground truncate",children:"Performance Prediction"}),e.jsx("p",{className:"text-muted-foreground text-sm break-words",children:"KI-basierte Erfolgs-Prognose"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs(I,{className:"bg-primary border-0 p-4 w-full min-w-0",children:[e.jsx("div",{className:"text-primary-foreground/80 text-sm mb-1",children:"Erwartete CTR"}),e.jsx("div",{className:"text-3xl text-primary-foreground font-bold tabular-nums",children:"2.8%"}),e.jsx("div",{className:"text-primary-foreground/80 text-xs mt-2",children:"+38% vs. Branche"})]}),e.jsxs(I,{className:"bg-foreground border-0 p-4 w-full min-w-0",children:[e.jsx("div",{className:"text-background/80 text-sm mb-1",children:"Erwartete CVR"}),e.jsx("div",{className:"text-3xl text-background font-bold tabular-nums",children:"4.2%"}),e.jsx("div",{className:"text-background/80 text-xs mt-2",children:"Hochwertige Leads"})]}),e.jsxs(I,{className:"bg-muted border-border p-4 w-full min-w-0",children:[e.jsx("div",{className:"text-muted-foreground text-sm mb-1",children:"Prognostizierter ROAS"}),e.jsx("div",{className:"text-3xl text-foreground font-bold tabular-nums",children:"5.2x"}),e.jsx("div",{className:"text-muted-foreground text-xs mt-2",children:"Excellent ROI"})]})]}),e.jsxs(I,{className:"bg-muted border-border p-5 w-full max-w-full overflow-hidden",children:[e.jsx("h3",{className:"text-foreground mb-4",children:"Audience Insights"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1 min-w-0 gap-2",children:[e.jsx("span",{className:"text-muted-foreground truncate",children:"Potentielle Reichweite"}),e.jsx("span",{className:"text-foreground tabular-nums shrink-0",children:"2.4M - 3.2M"})]}),e.jsx(Q,{value:75,className:"h-2"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1 min-w-0 gap-2",children:[e.jsx("span",{className:"text-muted-foreground truncate",children:"Kaufbereitschaft"}),e.jsx("span",{className:"text-primary tabular-nums shrink-0",children:"Hoch (82%)"})]}),e.jsx(Q,{value:82,className:"h-2"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1 min-w-0 gap-2",children:[e.jsx("span",{className:"text-muted-foreground truncate",children:"Wettbewerbsintensit√§t"}),e.jsx("span",{className:"text-foreground tabular-nums shrink-0",children:"Mittel (65%)"})]}),e.jsx(Q,{value:65,className:"h-2"})]})]})]}),e.jsxs(I,{className:"bg-muted border-border p-5 w-full max-w-full overflow-hidden",children:[e.jsx("h3",{className:"text-foreground mb-4",children:"Beste Performance-Zeitr√§ume"}),e.jsx("div",{className:"w-full max-w-full overflow-x-auto",children:e.jsx("div",{className:"grid grid-cols-7 gap-2 min-w-[420px]",children:["Mo","Di","Mi","Do","Fr","Sa","So"].map((r,s)=>e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-2",children:r}),e.jsx("div",{className:`h-16 rounded ${s>=4?"bg-primary":s>=2?"bg-foreground":"bg-border"}`})]},r))})}),e.jsx("p",{className:"text-sm text-muted-foreground mt-3 break-words",children:"Beste Performance: Freitag-Sonntag, 18:00-22:00 Uhr"})]})]})]}),t.currentStep===6&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6 min-w-0",children:[e.jsx("div",{className:"w-10 h-10 bg-primary rounded-lg flex items-center justify-center shrink-0",children:e.jsx(me,{className:"w-6 h-6 text-primary-foreground"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h2",{className:"text-foreground truncate",children:"Review & Launch"}),e.jsx("p",{className:"text-muted-foreground text-sm break-words",children:"Finale √úbersicht & Kampagnenstart"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(I,{className:"bg-muted border-border p-5 w-full max-w-full overflow-hidden",children:[e.jsx("h3",{className:"text-foreground mb-3",children:"Kampagnen-Zusammenfassung"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Produkt"}),e.jsx("div",{className:"text-foreground truncate",children:t.formData.productName||"Nicht angegeben"})]}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Zielgruppe"}),e.jsx("div",{className:"text-foreground truncate",children:t.formData.targetAudience||"Nicht angegeben"})]}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Budget"}),e.jsxs("div",{className:"text-foreground truncate",children:["‚Ç¨",t.formData.budget||"0"," / Tag"]})]}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Laufzeit"}),e.jsxs("div",{className:"text-foreground truncate",children:[t.formData.duration||"0"," Tage"]})]})]})]}),e.jsxs(I,{className:"bg-primary/10 border-primary p-5 w-full max-w-full overflow-hidden",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3 min-w-0",children:[e.jsx(P,{className:"w-6 h-6 text-primary shrink-0"}),e.jsx("h3",{className:"text-foreground truncate",children:"Kampagne bereit zum Start!"})]}),e.jsx("p",{className:"text-foreground/80 text-sm break-words",children:"Alle Einstellungen wurden √ºberpr√ºft. Ihre Kampagne kann jetzt gestartet werden."})]}),Y&&e.jsxs(I,{className:"mt-3 p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"text-sm font-medium",children:"Generating creative‚Ä¶"}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Status: ",oe]})]}),e.jsx(Q,{value:Be??0,className:"h-2"})]}),K&&e.jsx(I,{className:"mt-3 p-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Quality score"}),e.jsxs("div",{className:"text-lg font-semibold",children:[typeof K=="object"?K.satisfaction??K.score??"n/a":typeof K=="number"?K:"n/a","%"]})]}),e.jsx("div",{className:"text-sm text-muted-foreground max-w-xs text-right",children:typeof K=="object"&&(K.comment||K.summary)||"Model evaluation of the creative relevance and clarity."})]})}),e.jsxs("div",{className:"bg-muted border border-border rounded-lg p-4 w-full max-w-full overflow-hidden",children:[e.jsx("h4",{className:"text-foreground mb-3",children:"Was passiert nach dem Launch?"}),e.jsxs("ul",{className:"space-y-2 text-sm text-foreground/80",children:[e.jsxs("li",{className:"flex items-start gap-2 min-w-0",children:[e.jsx(P,{className:"w-4 h-4 text-primary mt-0.5 shrink-0"}),e.jsx("span",{className:"break-words",children:"Kampagne wird bei Meta zur Freigabe eingereicht"})]}),e.jsxs("li",{className:"flex items-start gap-2 min-w-0",children:[e.jsx(P,{className:"w-4 h-4 text-primary mt-0.5 shrink-0"}),e.jsx("span",{className:"break-words",children:"Automatisches A/B Testing startet"})]}),e.jsxs("li",{className:"flex items-start gap-2 min-w-0",children:[e.jsx(P,{className:"w-4 h-4 text-primary mt-0.5 shrink-0"}),e.jsx("span",{className:"break-words",children:"Echtzeit-Performance-Tracking aktiviert"})]}),e.jsxs("li",{className:"flex items-start gap-2 min-w-0",children:[e.jsx(P,{className:"w-4 h-4 text-primary mt-0.5 shrink-0"}),e.jsx("span",{className:"break-words",children:"KI-Optimierung l√§uft kontinuierlich im Hintergrund"})]})]})]}),e.jsxs(G,{className:"w-full bg-primary hover:bg-primary/90 text-primary-foreground h-12",children:[e.jsx(me,{className:"w-5 h-5 mr-2"}),"Kampagne jetzt starten"]}),e.jsx(G,{onClick:Fe,variant:"outline",className:"w-full border-border text-foreground hover:bg-muted h-12",children:"Als Entwurf speichern"}),e.jsxs("div",{className:"mt-4 grid grid-cols-2 gap-3",children:[e.jsx(G,{onClick:()=>{try{const r=a!==null?v[a]:v[0]||null,s={meta:{productName:t.formData.productName,targetAudience:t.formData.targetAudience},creative:r||v},o=new Blob([JSON.stringify(s,null,2)],{type:"application/json"}),x=URL.createObjectURL(o),j=document.createElement("a");j.href=x,j.download=`${(t.formData.productName||"creative").replace(/\s+/g,"_")}.json`,document.body.appendChild(j),j.click(),j.remove(),URL.revokeObjectURL(x),T.success("Creative exported")}catch{T.error("Export failed")}},className:"w-full",variant:"outline",children:"Export JSON"}),e.jsx(G,{onClick:async()=>{try{if(!ie)throw new Error("Bitte zuerst eine KI‚ÄëGenerierung abschlie√üen.");await lr({output:ie,creativeId:X}),Ee(!0),T.success("Saved to Library")}catch(r){const s=r instanceof Error?r.message:"Save failed";T.error(s)}},className:"w-full",disabled:fe||!ie,children:fe?"Saved":"Save to Library"})]})]})]}),t.currentStep!==4&&e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mt-8 pt-6 border-t border-border",children:[e.jsxs(G,{onClick:Ge,disabled:t.currentStep===1,variant:"outline",className:"border-border text-foreground hover:bg-muted w-full sm:w-auto",children:[e.jsx(tr,{className:"w-4 h-4 mr-2"}),"Zur√ºck"]}),e.jsxs(G,{onClick:Ve,disabled:t.currentStep===re.length,className:"bg-primary hover:bg-primary/90 text-primary-foreground w-full sm:w-auto",children:[Oe(),e.jsx(sr,{className:"w-4 h-4 ml-2"})]})]})]})}),e.jsxs("div",{className:"lg:col-span-1 space-y-4 lg:space-y-6 min-w-0",children:[e.jsx(mr,{copy:a!==null?v[a]:void 0,productName:t.formData.productName}),e.jsx(ur,{score:94})]}),e.jsxs("div",{className:"lg:col-span-1 min-w-0",children:[e.jsxs("details",{className:"lg:hidden rounded-xl border border-border bg-card",children:[e.jsxs("summary",{className:"px-4 py-3 cursor-pointer text-foreground font-medium flex items-center gap-2",children:[e.jsx(te,{className:"w-5 h-5 text-primary"}),"AI Copy Generator √∂ffnen"]}),e.jsx("div",{className:"p-4 border-t border-border",children:e.jsx(ve,{productName:t.formData.productName,productDescription:t.formData.productDescription,targetAudience:t.formData.targetAudience,uniqueSellingPoint:t.formData.uniqueSellingPoint,strategyId:t.formData.strategyId||null,onSelectCopy:r=>{const s={headline:r.headline,description:r.description,cta:r.cta};l(o=>[...o,s]),p(v.length)}})})]}),e.jsx("div",{className:"hidden lg:block h-auto lg:h-[800px]",children:e.jsx(I,{className:"bg-card border-border h-full overflow-hidden min-w-0",children:e.jsx(ve,{productName:t.formData.productName,productDescription:t.formData.productDescription,targetAudience:t.formData.targetAudience,uniqueSellingPoint:t.formData.uniqueSellingPoint,strategyId:t.formData.strategyId||null,onSelectCopy:r=>{const s={headline:r.headline,description:r.description,cta:r.cta};l(o=>[...o,s]),p(v.length)}})})})]})]}),e.jsx("div",{className:"mt-4 lg:col-span-1",children:e.jsxs(I,{className:"p-4 border-border bg-card",children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Ad Research (select to include)"}),e.jsx(fr,{limit:8,selectedIds:M,refreshKey:de,onToggle:r=>{Z(s=>s.includes(r)?s.filter(o=>o!==r):[...s,r])}}),e.jsxs("div",{className:"mt-3 text-sm text-muted-foreground",children:["Selected: ",e.jsx("strong",{children:M.length})]})]})})]})}export{kr as AdBuilderPage};

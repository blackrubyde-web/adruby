import{r as c,j as e,ay as Te,ax as Be,aX as De,a9 as W,e as T,aN as B,a7 as pe,aQ as ge,bE as be,aZ as Z,B as V,aG as J,aE as X,aW as je}from"./vendor-react-BtVdps6C.js";import{f as b}from"./vendor-Cwcl6ryW.js";import{P as ze}from"./PageShell-BcTt0uJw.js";import{H as Oe}from"./HeroHeader-D_79mwMf.js";import{C as u}from"./Card-BkrgSx6M.js";import{C as D}from"./Chip-BZQq5WZ-.js";import{s as v,P as qe}from"./creative-C4rWjoa1.js";import{f as Ue,b as Ge}from"./meta-BVXeiVXm.js";import{u as He}from"./useStrategies-CynI3epd.js";import{u as Qe}from"./useAnalyticsData-CRP3Fo9k.js";import"./vendor-radix-BA32w1ww.js";import"./vendor-supabase-CX3WxO18.js";import"./apiClient-Xod5JFW7.js";function We(){const[C,R]=c.useState([]),[y,M]=c.useState(!0),[k,_]=c.useState(null),h=c.useCallback(async()=>{M(!0),_(null);try{const j=await Ue();R(j.campaigns||[])}catch(j){const E=j instanceof Error?j.message:"Failed to load campaigns";_(E),R([])}finally{M(!1)}},[]);return c.useEffect(()=>{h().catch(()=>{})},[h]),{campaigns:C,loading:y,error:k,refresh:h}}function is(){var me,ue,he;const[C,R]=c.useState(""),[y,M]=c.useState("all"),[k,_]=c.useState(!0),[h,j]=c.useState(!1),[E,K]=c.useState(0),P=c.useRef(null),[z,O]=c.useState({}),[q,Y]=c.useState({}),{strategies:w}=He(),[f,I]=c.useState([]),[ee]=c.useState("30d"),[Ne,ve]=c.useState(0),{campaigns:se,loading:ye,error:te,refresh:we}=We(),{data:p,loading:Ae,error:re}=Qe(ee,!1,"meta",Ne),U=s=>{const t=String(s||"").toLowerCase();return t.includes("pause")?"paused":t.includes("learn")?"learning":"active"},Se=s=>{const t=Math.min(60,s.roas*12),n=Math.min(25,s.ctr*8),r=s.conversions>0?Math.min(15,Math.log10(s.conversions+1)*10):0;return Math.max(20,Math.min(100,Math.round(t+n+r)))},Ce=(s,t)=>{let n="increase";t.roas>=4&&t.ctr>=2.5&&(n="duplicate"),t.roas<1&&(n="kill"),t.roas>=1&&t.roas<2&&(n="decrease");const r=Math.max(60,Math.min(95,Math.round(50+t.roas*8+t.ctr*3)));return{id:s,recommendation:n,confidence:r,reason:{duplicate:"Starke ROAS und CTR. Skalierung empfohlen.",increase:"Solide Performance. Budget kann vorsichtig erhöht werden.",decrease:"ROAS unter Ziel. Budget reduzieren und Creatives testen.",kill:"Performance deutlich unter Ziel. Pause empfohlen."}[n],expectedImpact:n==="duplicate"?"+30-50% Umsatzpotenzial bei gleichbleibender Effizienz":"Performance-Optimierung durch Budget-Anpassung",details:[`ROAS: ${t.roas.toFixed(2)}x`,`CTR: ${t.ctr.toFixed(2)}%`,`Conversions: ${t.conversions}`]}};c.useEffect(()=>{const s=(se||[]).map(t=>{const n=Number(t.impressions||0),r=Number(t.clicks||0),a=Number(t.spend||0),o=Number(t.revenue||0),l=Number(t.ctr||0),d=Number(t.roas||0),i=Number(t.conversions||0),x=r>0?a/r:0,m=Se({roas:d,ctr:l,conversions:i}),g=Ce(`analysis-${t.id}`,{roas:d,ctr:l,conversions:i}),F=t.strategyId||null,_e=`adset:${t.id}-adset`,Ee=`ad:${t.id}-ad`,fe=z[_e]??F,Ke=z[Ee]??fe,Pe={id:`${t.id}-ad`,name:`${t.name} · Gesamt`,campaignId:t.id,status:U(t.status),impressions:n,clicks:r,ctr:l,cpc:x,conversions:i,spend:a,revenue:o,roas:d,performanceScore:m,aiAnalysis:g,strategyId:Ke},Le={id:`${t.id}-adset`,name:"Gesamt",status:U(t.status),impressions:n,clicks:r,ctr:l,cpc:x,conversions:i,spend:a,revenue:o,roas:d,performanceScore:m,ads:[Pe],expanded:!1,strategyId:fe};return{id:t.id,name:t.name,status:U(t.status),impressions:n,clicks:r,ctr:l,cpc:x,conversions:i,spend:a,revenue:o,roas:d,performanceScore:m,adSets:[Le],expanded:!1,strategyId:F}});I(s)},[se,z]),c.useEffect(()=>{let s=!1;return(async()=>{const{data:t}=await v.auth.getSession();if(!t.session||s)return;const{data:n,error:r}=await v.from("meta_strategy_assignments").select("entity_type,entity_id,strategy_id");if(s||r||!n)return;const a={};n.forEach(o=>{const l=`${o.entity_type}:${o.entity_id}`;a[l]=o.strategy_id||null}),O(a)})(),()=>{s=!0}},[]);const $=c.useMemo(()=>{const s=C.trim().toLowerCase();return f.filter(t=>y!=="all"&&t.status!==y?!1:!s||t.name.toLowerCase().includes(s)?!0:t.adSets.some(n=>n.name.toLowerCase().includes(s)?!0:n.ads.some(r=>r.name.toLowerCase().includes(s))))},[f,y,C]),G=((me=p==null?void 0:p.summary)==null?void 0:me.spend)??f.reduce((s,t)=>s+t.spend,0),ne=((ue=p==null?void 0:p.summary)==null?void 0:ue.revenue)??f.reduce((s,t)=>s+t.revenue,0),ke=((he=p==null?void 0:p.summary)==null?void 0:he.roas)??(G>0?ne/G:0),Ie=f.reduce((s,t)=>s+t.adSets.length,0),$e=f.reduce((s,t)=>s+t.adSets.reduce((n,r)=>n+r.ads.length,0),0),A=s=>{switch(s){case"active":return"text-green-500 bg-green-500/20";case"paused":return"text-orange-500 bg-orange-500/20";case"learning":return"text-blue-500 bg-blue-500/20";default:return"text-muted-foreground bg-muted/20"}},H=s=>s>=85?"text-green-500":s>=70?"text-blue-500":s>=50?"text-orange-500":"text-red-500",L=s=>{switch(s){case"kill":return{color:"#ef4444",bg:"bg-red-500/10",border:"border-red-500/30",icon:e.jsx(Z,{className:"w-4 h-4"}),label:"Kill Ad",actionLabel:"Pause Ad",action:"pause",confirmText:"Diese Kampagne in Meta pausieren?"};case"duplicate":return{color:"#10b981",bg:"bg-green-500/10",border:"border-green-500/30",icon:e.jsx(V,{className:"w-4 h-4"}),label:"Duplicate Ad",actionLabel:"Duplicate",action:"duplicate",confirmText:"Diese Kampagne in Meta duplizieren (Copy ist pausiert)?"};case"increase":return{color:"#3b82f6",bg:"bg-blue-500/10",border:"border-blue-500/30",icon:e.jsx(J,{className:"w-4 h-4"}),label:"Increase Budget",actionLabel:"Increase +50%",action:"increase",scalePct:.5,confirmText:"Budget dieser Kampagne um 50% erhöhen?"};case"decrease":default:return{color:"#f59e0b",bg:"bg-orange-500/10",border:"border-orange-500/30",icon:e.jsx(X,{className:"w-4 h-4"}),label:"Decrease Budget",actionLabel:"Decrease -30%",action:"decrease",scalePct:.3,confirmText:"Budget dieser Kampagne um 30% reduzieren?"}}},Fe=(s,t)=>{I(n=>n.map(r=>r.id===s?{...r,status:t,adSets:r.adSets.map(a=>({...a,status:t,ads:a.ads.map(o=>({...o,status:t}))}))}:r))},Q=s=>/^\d+$/.test(s),ae=s=>{I(f.map(t=>t.id===s?{...t,expanded:!t.expanded}:t))},oe=(s,t)=>{I(f.map(n=>n.id===s?{...n,adSets:n.adSets.map(r=>r.id===t?{...r,expanded:!r.expanded}:r)}:n))},S=async(s,t,n)=>{var a,o;const r=t||null;try{const{data:l}=await v.auth.getSession(),d=(o=(a=l.session)==null?void 0:a.user)==null?void 0:o.id;if(!d)throw new Error("Bitte zuerst anmelden.");if(n==="campaign"){const{error:i}=await v.from("meta_campaigns").update({strategy_id:r}).or(`facebook_campaign_id.eq.${s},id.eq.${s}`);if(i)throw i}else{const i=n==="adset"?"adset":"ad",x=`${i}:${s}`;if(r){const{error:m}=await v.from("meta_strategy_assignments").upsert({user_id:d,entity_type:i,entity_id:s,strategy_id:r},{onConflict:"user_id,entity_type,entity_id"});if(m)throw m;O(g=>({...g,[x]:r}))}else{const{error:m}=await v.from("meta_strategy_assignments").delete().eq("entity_type",i).eq("entity_id",s).eq("user_id",d);if(m)throw m;O(g=>{const F={...g};return delete F[x],F})}}I(i=>i.map(x=>n==="campaign"&&x.id===s?{...x,strategyId:r||void 0}:n==="adset"?{...x,adSets:x.adSets.map(m=>m.id===s?{...m,strategyId:r||void 0}:m)}:n==="ad"?{...x,adSets:x.adSets.map(m=>({...m,ads:m.ads.map(g=>g.id===s?{...g,strategyId:r||void 0}:g)}))}:x)),b.success(`Strategy updated for ${n}`)}catch(l){const d=l instanceof Error?l.message:"Strategy update failed";b.error(d)}},le=async(s,t)=>{if(!t.campaignId){b.error("Meta campaign ID fehlt.");return}if(!Q(t.campaignId)){b.error("Diese Kampagne ist nicht mit Meta verknüpft. Bitte Sync ausführen.");return}if(!window.confirm(s.confirmText))return;const n=`${t.campaignId}:${s.action}`;if(!q[n]){Y(r=>({...r,[n]:!0}));try{const r=await Ge({campaignId:t.campaignId,action:s.action,scalePct:s.scalePct});s.action==="pause"&&Fe(t.campaignId,"paused");let a="";s.action==="duplicate"&&(r!=null&&r.resultId)&&(a=` (ID ${r.resultId})`),(s.action==="increase"||s.action==="decrease")&&(r!=null&&r.previous)&&(r!=null&&r.next)&&(a=` (Budget ${r.previous} → ${r.next})`),b.success(`${s.actionLabel} umgesetzt für ${t.name}${a}`)}catch(r){const a=r instanceof Error?r.message:"Aktion fehlgeschlagen";b.error(a)}finally{Y(r=>({...r,[n]:!1}))}}},Re=async()=>{var t;if(h)return;const s=new AbortController;P.current=s,j(!0),K(0);try{const n="".replace(/\/$/,""),r=n?`${n}/api/meta-sync`:"/api/meta-sync",{data:a}=await v.auth.getSession(),o=(t=a.session)==null?void 0:t.access_token;if(!o)throw new Error("Bitte zuerst anmelden.");K(15);const l=await fetch(r,{method:"POST",headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"},body:JSON.stringify({range:ee}),signal:s.signal}),d=await l.json();if(!l.ok)throw new Error((d==null?void 0:d.error)||"Sync failed");K(70),await we(),ve(i=>i+1),K(100),b.success("Sync completed")}catch(n){if((n&&typeof n=="object"&&"name"in n?n.name:null)==="AbortError")b.message("Sync cancelled");else{const a=n instanceof Error?n.message:"Sync failed";b.error(a)}}finally{j(!1),P.current=null}},Me=()=>{P.current&&P.current.abort()},N=(()=>{const s=[];return $.forEach(t=>{t.adSets.forEach(n=>{n.ads.forEach(r=>{s.push({ad:r,campaign:t.name,adSet:n.name})})})}),s})(),de=N.filter(s=>s.ad.aiAnalysis.recommendation==="kill"),ie=N.filter(s=>s.ad.aiAnalysis.recommendation==="duplicate"),ce=N.filter(s=>s.ad.aiAnalysis.recommendation==="increase"),xe=N.filter(s=>s.ad.aiAnalysis.recommendation==="decrease");return e.jsxs(ze,{children:[e.jsx(Oe,{title:"AI Campaign Analysis",subtitle:`AI-powered insights analyzing ${f.length} campaigns, ${Ie} ad sets, and ${$e} ads`,chips:e.jsxs(e.Fragment,{children:[e.jsxs(D,{children:["€",(G/1e3).toFixed(1),"K Spend"]}),e.jsxs(D,{children:["€",(ne/1e3).toFixed(1),"K Revenue"]}),e.jsxs(D,{children:[ke.toFixed(2),"x ROAS"]}),e.jsxs(D,{children:[N.length," AI Insights"]})]}),actions:e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:h?Me:Re,className:"px-4 py-2.5 bg-muted hover:bg-muted/80 rounded-xl font-semibold transition-all flex items-center gap-2",children:[e.jsx(Te,{className:`w-4 h-4 ${h?"animate-spin":""}`}),e.jsx("span",{className:"text-sm font-medium",children:h?"Cancel Sync":"Sync Data"})]}),e.jsxs("button",{className:"px-6 py-3 bg-gradient-to-r from-primary to-primary/80 text-primary-foreground rounded-xl hover:scale-105 transition-all duration-300 shadow-lg shadow-primary/30 flex items-center gap-2",children:[e.jsx(Be,{className:"w-4 h-4"}),e.jsx("span",{children:"Export Report"})]})]})}),h&&e.jsxs(u,{className:"p-4 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Syncing data..."}),e.jsxs("span",{className:"font-semibold text-foreground",children:[E,"%"]})]}),e.jsx(qe,{value:E,className:"h-2 mt-3"})]}),(ye||Ae)&&e.jsx(u,{className:"p-4 mb-4 text-sm text-muted-foreground",children:"Lade Kampagnen und Analytics…"}),(te||re)&&e.jsx(u,{className:"p-4 mb-4 border border-red-500/30 bg-red-500/5 text-red-600",children:te||re}),e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 lg:gap-6 w-full max-w-[100vw] overflow-x-hidden",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(u,{className:"p-4 mb-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3 sm:gap-4 min-w-0",children:[e.jsxs("div",{className:"flex-1 relative min-w-0",children:[e.jsx(De,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground"}),e.jsx("input",{type:"text",placeholder:"Search campaigns, ad sets, or ads...",value:C,onChange:s=>R(s.target.value),className:"w-full max-w-full pl-10 pr-4 py-2.5 bg-muted/50 border border-border/50 rounded-xl text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary/50"})]}),e.jsxs("select",{value:y,onChange:s=>M(s.target.value),className:"w-full sm:w-auto px-4 py-2.5 bg-muted/50 border border-border/50 rounded-xl text-foreground focus:outline-none focus:ring-2 focus:ring-primary/50",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"paused",children:"Paused"}),e.jsx("option",{value:"learning",children:"Learning"})]}),e.jsxs("button",{onClick:()=>_(!k),className:`w-full sm:w-auto px-4 py-2.5 rounded-xl font-semibold transition-all flex items-center justify-center gap-2 ${k?"bg-primary text-primary-foreground shadow-lg shadow-primary/30":"bg-muted hover:bg-muted/80"}`,children:[e.jsx(W,{className:"w-5 h-5"}),"AI Panel"]})]})}),e.jsxs(u,{className:"hidden lg:block overflow-hidden p-0",children:[e.jsx("div",{className:"bg-muted/30 border-b border-border/30 p-4",children:e.jsxs("div",{className:"grid grid-cols-12 gap-4 text-sm font-semibold text-muted-foreground",children:[e.jsx("div",{className:"col-span-3",children:"Campaign / Ad Set / Ad"}),e.jsx("div",{className:"col-span-1 text-center",children:"Status"}),e.jsx("div",{className:"col-span-1 text-right",children:"Impressions"}),e.jsx("div",{className:"col-span-1 text-right",children:"CTR"}),e.jsx("div",{className:"col-span-1 text-right",children:"CPC"}),e.jsx("div",{className:"col-span-1 text-right",children:"Conv."}),e.jsx("div",{className:"col-span-1 text-right",children:"Spend"}),e.jsx("div",{className:"col-span-1 text-right",children:"ROAS"}),e.jsx("div",{className:"col-span-1 text-center",children:"Score"}),e.jsx("div",{className:"col-span-1 text-center",children:"Strategy"})]})}),$.length===0?e.jsx("div",{className:"p-10 text-center text-muted-foreground",children:"Keine Kampagnen gefunden. Verbinde Meta oder starte einen Sync."}):e.jsx("div",{className:"divide-y divide-border/30",children:$.map(s=>e.jsxs("div",{children:[e.jsx("div",{className:"hover:bg-muted/20 transition-colors",children:e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"grid grid-cols-12 gap-4 items-center text-sm",children:[e.jsxs("div",{className:"col-span-3 flex items-center gap-2",children:[e.jsx("button",{onClick:()=>ae(s.id),className:"p-1 hover:bg-muted/50 rounded transition-colors",children:s.expanded?e.jsx(T,{className:"w-4 h-4"}):e.jsx(B,{className:"w-4 h-4"})}),e.jsx(pe,{className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"font-semibold text-foreground",children:s.name})]}),e.jsx("div",{className:"col-span-1 flex justify-center",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-semibold ${A(s.status)}`,children:s.status})}),e.jsxs("div",{className:"col-span-1 text-right font-mono text-foreground",children:[(s.impressions/1e6).toFixed(2),"M"]}),e.jsxs("div",{className:"col-span-1 text-right font-mono text-foreground",children:[s.ctr.toFixed(2),"%"]}),e.jsxs("div",{className:"col-span-1 text-right font-mono text-foreground",children:["€",s.cpc.toFixed(2)]}),e.jsx("div",{className:"col-span-1 text-right font-mono text-foreground",children:s.conversions}),e.jsxs("div",{className:"col-span-1 text-right font-mono text-foreground",children:["€",(s.spend/1e3).toFixed(1),"K"]}),e.jsxs("div",{className:"col-span-1 text-right font-mono font-bold text-foreground",children:[s.roas.toFixed(2),"x"]}),e.jsx("div",{className:"col-span-1 flex justify-center",children:e.jsx("span",{className:`font-bold ${H(s.performanceScore)}`,children:s.performanceScore})}),e.jsx("div",{className:"col-span-1 flex justify-center",children:e.jsxs("select",{value:s.strategyId||"",onChange:t=>S(s.id,t.target.value,"campaign"),className:"px-2 py-1 bg-muted/50 border border-border/50 rounded text-xs focus:outline-none focus:ring-1 focus:ring-primary/50",children:[e.jsx("option",{value:"",children:"No Strategy"}),w.map(t=>e.jsx("option",{value:t.id,children:t.title},t.id))]})})]})})}),s.expanded&&s.adSets.map(t=>e.jsxs("div",{children:[e.jsx("div",{className:"bg-muted/10 hover:bg-muted/20 transition-colors",children:e.jsx("div",{className:"p-4 pl-12",children:e.jsxs("div",{className:"grid grid-cols-12 gap-4 items-center text-sm",children:[e.jsxs("div",{className:"col-span-3 flex items-center gap-2",children:[e.jsx("button",{onClick:()=>oe(s.id,t.id),className:"p-1 hover:bg-muted/50 rounded transition-colors",children:t.expanded?e.jsx(T,{className:"w-4 h-4"}):e.jsx(B,{className:"w-4 h-4"})}),e.jsx(ge,{className:"w-4 h-4 text-blue-500"}),e.jsx("span",{className:"font-medium text-foreground",children:t.name})]}),e.jsx("div",{className:"col-span-1 flex justify-center",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-semibold ${A(t.status)}`,children:t.status})}),e.jsxs("div",{className:"col-span-1 text-right font-mono text-muted-foreground",children:[(t.impressions/1e6).toFixed(2),"M"]}),e.jsxs("div",{className:"col-span-1 text-right font-mono text-muted-foreground",children:[t.ctr.toFixed(2),"%"]}),e.jsxs("div",{className:"col-span-1 text-right font-mono text-muted-foreground",children:["€",t.cpc.toFixed(2)]}),e.jsx("div",{className:"col-span-1 text-right font-mono text-muted-foreground",children:t.conversions}),e.jsxs("div",{className:"col-span-1 text-right font-mono text-muted-foreground",children:["€",(t.spend/1e3).toFixed(1),"K"]}),e.jsxs("div",{className:"col-span-1 text-right font-mono font-bold text-muted-foreground",children:[t.roas.toFixed(2),"x"]}),e.jsx("div",{className:"col-span-1 flex justify-center",children:e.jsx("span",{className:`font-bold ${H(t.performanceScore)}`,children:t.performanceScore})}),e.jsx("div",{className:"col-span-1 flex justify-center",children:e.jsxs("select",{value:t.strategyId||s.strategyId||"",onChange:n=>S(t.id,n.target.value,"adset"),className:"px-2 py-1 bg-muted/50 border border-border/50 rounded text-xs focus:outline-none focus:ring-1 focus:ring-primary/50",children:[e.jsx("option",{value:"",children:"Inherit"}),w.map(n=>e.jsx("option",{value:n.id,children:n.title},n.id))]})})]})})}),t.expanded&&t.ads.map(n=>{const r=L(n.aiAnalysis.recommendation);return e.jsx("div",{className:"bg-muted/5 hover:bg-muted/15 transition-colors border-l-4",style:{borderColor:r.color},children:e.jsx("div",{className:"p-4 pl-20",children:e.jsxs("div",{className:"grid grid-cols-12 gap-4 items-center text-sm",children:[e.jsxs("div",{className:"col-span-3 flex items-center gap-2",children:[e.jsx(be,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{className:"text-foreground",children:n.name}),e.jsxs("div",{className:`px-2 py-1 rounded-full text-xs font-semibold flex items-center gap-1 ${r.bg} border ${r.border}`,style:{color:r.color},children:[r.icon,r.label]})]}),e.jsx("div",{className:"col-span-1 flex justify-center",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-semibold ${A(n.status)}`,children:n.status})}),e.jsxs("div",{className:"col-span-1 text-right font-mono text-muted-foreground",children:[(n.impressions/1e3).toFixed(0),"K"]}),e.jsxs("div",{className:"col-span-1 text-right font-mono text-muted-foreground",children:[n.ctr.toFixed(2),"%"]}),e.jsxs("div",{className:"col-span-1 text-right font-mono text-muted-foreground",children:["€",n.cpc.toFixed(2)]}),e.jsx("div",{className:"col-span-1 text-right font-mono text-muted-foreground",children:n.conversions}),e.jsxs("div",{className:"col-span-1 text-right font-mono text-muted-foreground",children:["€",(n.spend/1e3).toFixed(1),"K"]}),e.jsxs("div",{className:"col-span-1 text-right font-mono font-bold text-muted-foreground",children:[n.roas.toFixed(2),"x"]}),e.jsx("div",{className:"col-span-1 flex justify-center",children:e.jsx("span",{className:`font-bold ${H(n.performanceScore)}`,children:n.performanceScore})}),e.jsx("div",{className:"col-span-1 flex justify-center",children:e.jsxs("select",{value:n.strategyId||t.strategyId||s.strategyId||"",onChange:a=>S(n.id,a.target.value,"ad"),className:"px-2 py-1 bg-muted/50 border border-border/50 rounded text-xs focus:outline-none focus:ring-1 focus:ring-primary/50",children:[e.jsx("option",{value:"",children:"Inherit"}),w.map(a=>e.jsx("option",{value:a.id,children:a.title},a.id))]})})]})})},n.id)})]},t.id))]},s.id))})]}),e.jsx("div",{className:"lg:hidden space-y-3",children:$.length===0?e.jsx(u,{className:"p-6 text-center text-muted-foreground",children:"Keine Kampagnen gefunden. Verbinde Meta oder starte einen Sync."}):$.map(s=>e.jsxs(u,{className:"overflow-hidden p-0",children:[e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3 min-w-0",children:[e.jsx("button",{onClick:()=>ae(s.id),className:"p-1 hover:bg-muted/50 rounded shrink-0",children:s.expanded?e.jsx(T,{className:"w-4 h-4"}):e.jsx(B,{className:"w-4 h-4"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx(pe,{className:"w-4 h-4 text-primary shrink-0"}),e.jsx("div",{className:"font-semibold text-foreground truncate",children:s.name})]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-semibold ${A(s.status)}`,children:s.status}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["Impr: ",e.jsxs("span",{className:"text-foreground font-mono",children:[(s.impressions/1e6).toFixed(2),"M"]})]}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["CTR: ",e.jsxs("span",{className:"text-foreground font-mono",children:[s.ctr.toFixed(2),"%"]})]}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["ROAS: ",e.jsxs("span",{className:"text-foreground font-mono font-bold",children:[s.roas.toFixed(2),"x"]})]}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["Spend: ",e.jsxs("span",{className:"text-foreground font-mono",children:["€",(s.spend/1e3).toFixed(1),"K"]})]})]}),e.jsx("div",{className:"mt-3",children:e.jsxs("select",{value:s.strategyId||"",onChange:t=>S(s.id,t.target.value,"campaign"),className:"w-full px-3 py-2 bg-muted/50 border border-border/50 rounded-lg text-sm focus:outline-none focus:ring-1 focus:ring-primary/50",children:[e.jsx("option",{value:"",children:"No Strategy"}),w.map(t=>e.jsx("option",{value:t.id,children:t.title},t.id))]})})]})]})}),s.expanded&&e.jsx("div",{className:"border-t border-border/30",children:s.adSets.map(t=>e.jsx("div",{className:"p-4 border-b border-border/20",children:e.jsxs("div",{className:"flex items-start gap-3 min-w-0",children:[e.jsx("button",{onClick:()=>oe(s.id,t.id),className:"p-1 hover:bg-muted/50 rounded shrink-0",children:t.expanded?e.jsx(T,{className:"w-4 h-4"}):e.jsx(B,{className:"w-4 h-4"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx(ge,{className:"w-4 h-4 text-blue-500 shrink-0"}),e.jsx("div",{className:"font-medium text-foreground truncate",children:t.name})]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-semibold ${A(t.status)}`,children:t.status}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["ROAS: ",e.jsxs("span",{className:"text-foreground font-mono font-bold",children:[t.roas.toFixed(2),"x"]})]}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["Spend: ",e.jsxs("span",{className:"text-foreground font-mono",children:["€",(t.spend/1e3).toFixed(1),"K"]})]})]}),e.jsx("div",{className:"mt-3",children:e.jsxs("select",{value:t.strategyId||s.strategyId||"",onChange:n=>S(t.id,n.target.value,"adset"),className:"w-full px-3 py-2 bg-muted/50 border border-border/50 rounded-lg text-sm focus:outline-none focus:ring-1 focus:ring-primary/50",children:[e.jsx("option",{value:"",children:"Inherit"}),w.map(n=>e.jsx("option",{value:n.id,children:n.title},n.id))]})}),t.expanded&&e.jsx("div",{className:"mt-3 space-y-2",children:t.ads.map(n=>{const r=L(n.aiAnalysis.recommendation);return e.jsx("div",{className:"rounded-xl border border-border/40 bg-muted/10 p-3",children:e.jsxs("div",{className:"flex items-start gap-2 min-w-0",children:[e.jsx(be,{className:"w-4 h-4 text-green-500 shrink-0 mt-0.5"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"font-medium text-foreground truncate",children:n.name}),e.jsxs("div",{className:"mt-1 flex flex-wrap gap-2 text-xs",children:[e.jsx("span",{className:`px-2 py-1 rounded-full ${A(n.status)}`,children:n.status}),e.jsxs("span",{className:"text-muted-foreground",children:["CTR ",e.jsxs("span",{className:"text-foreground font-mono",children:[n.ctr.toFixed(2),"%"]})]}),e.jsxs("span",{className:"text-muted-foreground",children:["ROAS ",e.jsxs("span",{className:"text-foreground font-mono font-bold",children:[n.roas.toFixed(2),"x"]})]})]}),e.jsx("div",{className:"mt-2",children:e.jsxs("select",{value:n.strategyId||t.strategyId||s.strategyId||"",onChange:a=>S(n.id,a.target.value,"ad"),className:"w-full px-3 py-2 bg-muted/50 border border-border/50 rounded-lg text-sm focus:outline-none focus:ring-1 focus:ring-primary/50",children:[e.jsx("option",{value:"",children:"Inherit"}),w.map(a=>e.jsx("option",{value:a.id,children:a.title},a.id))]})})]}),e.jsx("div",{className:"shrink-0",children:e.jsx("span",{className:`text-xs font-semibold px-2 py-1 rounded-full border ${r.border} ${r.bg}`,style:{color:r.color},children:r.label})})]})},n.id)})})]})]})},t.id))})]},s.id))})]}),k&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"lg:hidden mt-4 w-full max-w-full min-w-0",children:e.jsx(u,{className:"overflow-hidden p-0",children:e.jsxs("details",{className:"overflow-hidden",children:[e.jsxs("summary",{className:"px-4 py-3 cursor-pointer flex items-center justify-between",children:[e.jsxs("span",{className:"font-semibold text-foreground flex items-center gap-2",children:[e.jsx(W,{className:"w-5 h-5 text-primary"}),"AI Recommendations"]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"Tap to view"})]}),e.jsxs("div",{className:"p-4 border-t border-border/30 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"backdrop-blur-xl bg-red-500/10 rounded-xl border border-red-500/30 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(Z,{className:"w-5 h-5 text-red-500"}),e.jsx("span",{className:"text-2xl font-bold text-red-500",children:de.length})]}),e.jsx("div",{className:"text-xs font-semibold text-red-500",children:"Kill Ads"})]}),e.jsxs("div",{className:"backdrop-blur-xl bg-green-500/10 rounded-xl border border-green-500/30 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(V,{className:"w-5 h-5 text-green-500"}),e.jsx("span",{className:"text-2xl font-bold text-green-500",children:ie.length})]}),e.jsx("div",{className:"text-xs font-semibold text-green-500",children:"Duplicate"})]}),e.jsxs("div",{className:"backdrop-blur-xl bg-blue-500/10 rounded-xl border border-blue-500/30 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(J,{className:"w-5 h-5 text-blue-500"}),e.jsx("span",{className:"text-2xl font-bold text-blue-500",children:ce.length})]}),e.jsx("div",{className:"text-xs font-semibold text-blue-500",children:"Increase"})]}),e.jsxs("div",{className:"backdrop-blur-xl bg-orange-500/10 rounded-xl border border-orange-500/30 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(X,{className:"w-5 h-5 text-orange-500"}),e.jsx("span",{className:"text-2xl font-bold text-orange-500",children:xe.length})]}),e.jsx("div",{className:"text-xs font-semibold text-orange-500",children:"Decrease"})]})]}),e.jsx("div",{className:"space-y-3",children:N.map(({ad:s,campaign:t,adSet:n})=>{const r=L(s.aiAnalysis.recommendation),a=`${s.campaignId}:${r.action}`,o=!!q[a],l=Q(s.campaignId),d=o||!l;return e.jsx("div",{className:`backdrop-blur-xl bg-card/60 rounded-xl border-2 ${r.border} shadow-xl overflow-hidden`,children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[e.jsx("div",{className:`p-2 ${r.bg} rounded-lg flex-shrink-0`,style:{color:r.color},children:r.icon}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-bold text-foreground text-sm mb-1 truncate",children:s.name}),e.jsxs("div",{className:"text-xs text-muted-foreground truncate",children:[t," → ",n]})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"text-xs font-semibold mb-1",style:{color:r.color},children:r.label}),e.jsx("div",{className:"text-xs text-muted-foreground leading-relaxed",children:s.aiAnalysis.reason})]}),e.jsxs("div",{className:"mb-3 p-2 bg-muted/30 rounded-lg",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"Expected Impact"}),e.jsx("div",{className:"text-sm font-bold text-foreground",children:s.aiAnalysis.expectedImpact})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs mb-1",children:[e.jsx("span",{className:"text-muted-foreground",children:"AI Confidence"}),e.jsxs("span",{className:"font-bold",style:{color:r.color},children:[s.aiAnalysis.confidence,"%"]})]}),e.jsx("div",{className:"h-1.5 bg-muted rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full rounded-full transition-all duration-1000",style:{width:`${s.aiAnalysis.confidence}%`,backgroundColor:r.color}})})]}),e.jsx("div",{className:"mb-3 space-y-1",children:s.aiAnalysis.details.slice(0,2).map((i,x)=>e.jsxs("div",{className:"flex items-start gap-1 text-xs text-muted-foreground",children:[e.jsx(je,{className:"w-3 h-3 flex-shrink-0 mt-0.5",style:{color:r.color}}),e.jsx("span",{className:"leading-tight",children:i})]},x))}),e.jsx("button",{onClick:()=>le(r,s),disabled:d,title:l?"":"Nicht mit Meta verknüpft. Bitte Sync ausführen.",className:`w-full px-4 py-2 rounded-lg font-semibold text-sm transition-all shadow-lg ${d?"opacity-70 cursor-not-allowed":""}`,style:{backgroundColor:r.color,color:"white"},children:o?"Wird angewendet...":r.actionLabel})]})},s.id)})})]})]})})}),e.jsxs("div",{className:"hidden lg:block w-[380px] flex-shrink-0 space-y-4 sticky top-24 h-fit max-h-[calc(100vh-8rem)] overflow-y-auto",children:[e.jsxs(u,{className:"bg-gradient-to-br from-primary/10 to-card border-primary/30 p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"p-3 bg-primary/20 rounded-xl",children:e.jsx(W,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-foreground",children:"AI Recommendations"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Real-time analysis"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500 animate-pulse"}),e.jsx("span",{className:"text-muted-foreground",children:"Updated 30 seconds ago"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"backdrop-blur-xl bg-red-500/10 rounded-xl border border-red-500/30 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(Z,{className:"w-5 h-5 text-red-500"}),e.jsx("span",{className:"text-2xl font-bold text-red-500",children:de.length})]}),e.jsx("div",{className:"text-xs font-semibold text-red-500",children:"Kill Ads"})]}),e.jsxs("div",{className:"backdrop-blur-xl bg-green-500/10 rounded-xl border border-green-500/30 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(V,{className:"w-5 h-5 text-green-500"}),e.jsx("span",{className:"text-2xl font-bold text-green-500",children:ie.length})]}),e.jsx("div",{className:"text-xs font-semibold text-green-500",children:"Duplicate"})]}),e.jsxs("div",{className:"backdrop-blur-xl bg-blue-500/10 rounded-xl border border-blue-500/30 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(J,{className:"w-5 h-5 text-blue-500"}),e.jsx("span",{className:"text-2xl font-bold text-blue-500",children:ce.length})]}),e.jsx("div",{className:"text-xs font-semibold text-blue-500",children:"Increase"})]}),e.jsxs("div",{className:"backdrop-blur-xl bg-orange-500/10 rounded-xl border border-orange-500/30 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(X,{className:"w-5 h-5 text-orange-500"}),e.jsx("span",{className:"text-2xl font-bold text-orange-500",children:xe.length})]}),e.jsx("div",{className:"text-xs font-semibold text-orange-500",children:"Decrease"})]})]}),e.jsx("div",{className:"space-y-3",children:N.map(({ad:s,campaign:t,adSet:n})=>{const r=L(s.aiAnalysis.recommendation),a=`${s.campaignId}:${r.action}`,o=!!q[a],l=Q(s.campaignId),d=o||!l;return e.jsx(u,{className:`border-2 ${r.border} overflow-hidden hover:scale-105 transition-all p-0`,children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[e.jsx("div",{className:`p-2 ${r.bg} rounded-lg flex-shrink-0`,style:{color:r.color},children:r.icon}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-bold text-foreground text-sm mb-1 truncate",children:s.name}),e.jsxs("div",{className:"text-xs text-muted-foreground truncate",children:[t," → ",n]})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"text-xs font-semibold mb-1",style:{color:r.color},children:r.label}),e.jsx("div",{className:"text-xs text-muted-foreground leading-relaxed",children:s.aiAnalysis.reason})]}),e.jsxs("div",{className:"mb-3 p-2 bg-muted/30 rounded-lg",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"Expected Impact"}),e.jsx("div",{className:"text-sm font-bold text-foreground",children:s.aiAnalysis.expectedImpact})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs mb-1",children:[e.jsx("span",{className:"text-muted-foreground",children:"AI Confidence"}),e.jsxs("span",{className:"font-bold",style:{color:r.color},children:[s.aiAnalysis.confidence,"%"]})]}),e.jsx("div",{className:"h-1.5 bg-muted rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full rounded-full transition-all duration-1000",style:{width:`${s.aiAnalysis.confidence}%`,backgroundColor:r.color}})})]}),e.jsx("div",{className:"mb-3 space-y-1",children:s.aiAnalysis.details.slice(0,2).map((i,x)=>e.jsxs("div",{className:"flex items-start gap-1 text-xs text-muted-foreground",children:[e.jsx(je,{className:"w-3 h-3 flex-shrink-0 mt-0.5",style:{color:r.color}}),e.jsx("span",{className:"leading-tight",children:i})]},x))}),e.jsx("button",{onClick:()=>le(r,s),disabled:d,title:l?"":"Nicht mit Meta verknüpft. Bitte Sync ausführen.",className:`w-full px-4 py-2 rounded-lg font-semibold text-sm transition-all hover:scale-105 shadow-lg ${d?"opacity-70 cursor-not-allowed":""}`,style:{backgroundColor:r.color,color:"white"},children:o?"Wird angewendet...":r.actionLabel})]})},s.id)})})]})]})]})]})}export{is as AIAnalysisPage};
